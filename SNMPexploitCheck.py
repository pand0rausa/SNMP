#! /usr/bin/python3

import os
import sys

class bcolors:
    OKGREEN = '\033[92m'
    FAIL = '\033[91m'
    ENDC = '\033[0m'


file = open("/root/snmp.txt","r")
for lines in file:
        cmd = "snmpwalk -v 2c -c public -t 1 " + str(lines.strip()) + " nsExtendObjects"
        result = os.system(cmd)
        vuln = type('NET-SNMP-EXTEND-MIB::nsExtendNumEntries.0 = INTEGER: 0')
        if result == vuln:
                print (bcolors.FAIL + lines.strip() + ": vulnerable to SNMP command injection" + bcolors.ENDC)
        else:
                print (bcolors.OKGREEN + lines.strip() + ": Not vulnerable" + bcolors.ENDC)

quit()
